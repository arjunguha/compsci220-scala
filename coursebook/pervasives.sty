\usepackage{titlesec}
\usepackage{fullpage}
\usepackage[dvipsnames]{color}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{comment}
\usepackage{listings}
\usepackage[listings,xparse]{tcolorbox}
\usepackage{subcaption}
\usepackage{dirtree}
\usepackage{tikz}
\usepackage{amssymb,etoolbox}
\usetikzlibrary{arrows,automata}

\expandafter\patchcmd\csname \string\lstinline\endcsname{%
  \leavevmode
  \bgroup
}{%
  \leavevmode
  \ifmmode\hbox\fi
  \bgroup
}{}{%
  \typeout{Patching of \string\lstinline\space failed!}%
}

\definecolor{bg}{rgb}{0.95,0.95,0.95}

\definecolor{kwcolor}{rgb}{0,0.4,0.2}
\definecolor{commentcolor}{rgb}{0.0,0.3,0.6}

\lstset{
  showstringspaces=false,
  keywordstyle=\color{kwcolor},
  commentstyle=\color{commentcolor}
}
% If mathescape is on, then then $ from command prompt screws things up.
\lstdefinestyle{lstconsole}{}

\lstdefinelanguage{console}{
  basicstyle=\ttfamily\footnotesize,
  mathescape=false,
  breaklines=true,
  keywordstyle=\color{blue},
  morekeywords={student@vm,scala>},
  alsoletter={:~$},
  morekeywords=[2]{student@vm:},
  keywordstyle=[2]{\color{red}},
  literate={\$}{{\textcolor{red}{\$}}}1
           {:}{{\textcolor{red}{:}}}1
           {~}{{\textcolor{red}{\textasciitilde}}}1,
}

\lstdefinelanguage{scala}{
  basicstyle=\ttfamily\footnotesize,
  mathescape=false,
  morekeywords={abstract,case,catch,class,def,%
    do,else,extends,false,final,finally,%
    for,if,implicit,import,match,mixin,%
    new,null,object,override,package,%
    private,protected,requires,return,sealed,%
    super,this,throw,trait,true,try,%
    type,val,var,while,with,yield},
  otherkeywords={=>,<-,<\%,<:,>:,\#,@},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[n]{/*}{*/},
  morestring=[b]",
  morestring=[b]',
  morestring=[b]"""
}

\lstnewenvironment{console}{\lstset{language=console}}{}

\newcommand{\consolefile}[1]{\lstinputlisting[language=console]{#1}}
\lstnewenvironment{scalacode}{\lstset{language=scala,basicstyle=\ttfamily\footnotesize}}{}
\lstnewenvironment{javacode}{\lstset{language=java,basicstyle=\ttfamily\footnotesize}}{}
\newcommand{\scalafile}[1]{%
  \begin{samepage}\lstinputlisting[language=scala,basicstyle=\ttfamily\footnotesize]{#1}\end{samepage}}
\newcommand{\scalainline}[1]{\lstinline[language=scala,basicstyle=\ttfamily]{#1}}

% \newmintinline{scala}{}
\newcommand{\javainline}[1]{\lstinline[language=java]{#1}}

\hypersetup{colorlinks,urlcolor=blue}

\titleformat{\chapter}{\normalfont\huge}{}{0pt}{\huge\bfseries}
%\simplechapter

% Don't prefix sections (and subsections) with chapter number
\renewcommand*\thesection{\arabic{section}}

\ifinstructormode
  \newtcolorbox{instructorbox}{colback=red!5!white, colframe=red!75!black}
  \newenvironment{instructor}%
  {\begin{instructorbox}\paragraph{Note for instructors.}}
  {\end{instructorbox}}
\else
  \excludecomment{instructor}
\fi

\newcommand{\classtime}[1]{\ifinstructormode~(#1 mins) \fi}

\newcommand{\instructornote}[1]{\ifinstructormode~#1 \fi}

\newcommand{\sbt}{\texttt{sbt}}

\newcounter{lecture_num}
\stepcounter{lecture_num}

\newcommand{\newlecture}{%
\chapter{\texorpdfstring{Lecture \the\value{lecture_num}}{file:reading/lecture\the\value{lecture_num}}}%
\stepcounter{lecture_num}%
}

\newcounter{discussion_num}
\stepcounter{discussion_num}

% \newdiscussion{My First One}
\newcommand{\newdiscussion}[1]{%
\chapter{\texorpdfstring{Discussion \the\value{discussion_num}: #1}{file:discussion/discussion\the\value{discussion_num}}}%
\stepcounter{discussion_num}%
}

\newcounter{hw_num}
\stepcounter{hw_num}

\newcommand{\newhw}[1]{%
\chapter{\texorpdfstring{Homework \the\value{hw_num}: #1}{file:hw/hw\the\value{hw_num}}}%
\stepcounter{hw_num}%
}



\newcommand{\due}[1]{\large\textbf{Due: #1 2016 1AM}}

\newtheorem{property}{Property}

\newtcolorbox{notationbox}{colback=green!5!white, colframe=green!75!black}

\newenvironment{notation}%
{\begin{notationbox}\paragraph{Notation}}%
{\end{notationbox}}

\newtcolorbox{thinkbox}{colback=green!5!white, colframe=green!75!black}

\newenvironment{think}%
{\begin{thinkbox}\paragraph{Think!}}%
{\end{thinkbox}}

