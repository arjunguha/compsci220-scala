\chapter{Project: Programming with combinators}
\savepdf{project-json-combinators}

\section{Introduction}
Remind students what a combinator is.

\section{Preliminaries}
Introduce JsonProc here using the key combinator.

\section{Programming Task}
For this assignment, you will be implementing several combinators that operate
on Json values. Additionally, you will be using these combinators to implement
various extractors on Json values.

\begin{enumerate}
    \item Implement a combinator that extracts the number from an input
    \texttt{JsonNumber}. If the input is not a \texttt{JsonNumber}, return the
    empty list. Otherwise, return a singleton list with just the number.
    \begin{scalacode}
    def number: JsonProc[Json,Double]
    \end{scalacode}

    \item Implement a combinator that extracts the given \texttt{index} from
    a \texttt{JsonArray}. If the input is not a \texttt{JsonArray} or if the index
    is not present in the array, return an empty list. Otherwise, return
    a singleton list with just the Json value at the given index.
    \begin{scalacode}
    def index(n: Int): JsonProc[Json,Json]
    \end{scalacode}

    \item Implement a combinator that returns all the elements in a
    \texttt{JsonArray}. If the input is not a \texttt{JsonArray}, return the
    empty list.
    \begin{scalacode}
    def iter: JsonProc[Json,Json]
    \end{scalacode}

    % Getting students to use >>> to make sure they understand JsonProcs
    \item Using the combinators defined so far and the \texttt{>>>} method,
    implement a function that takes a \texttt{JsonArray} and adds all the
    numbers in it.
    \begin{scalacode}
    def addAll(json: Json): Double
    \end{scalacode}

    \item Implement a combinator that extracts all the leaf values from an
    input Json value. Leaf values can only be \texttt{JsonNull},
    \texttt{JsonString}, \texttt{JsonNumber}, and \texttt{JsonBool}.
    \begin{scalacode}
    def recur: JsonProc[Json, Json]
    \end{scalacode}

    \item Implement a generic combinator that returns tuple that contains
    two copies of the input. This combinator will allow us to perform two
    separate operation on a given input.
    \begin{scalacode}
    def split[S]: JsonProc[S, (S, S)]
    \end{scalacode}

    \item Implement a generic combinator that takes tuple with two values
    of the same type and returns a list containing both the elements. This
    combinator will allow us to combine two separate inputs into one output.
    \begin{scalacode}
    def combine[A]: JsonProc[(A, A), A]
    \end{scalacode}

    \item Implement the combinator \texttt{first}. The input to first is a
    generic \texttt{JsonProc} called \texttt{proc} that consumes a value of
    type `A' and returns a value of type `B'. The output of \texttt{first} is
    a \texttt{JsonProc} that consumes a tuple and returns a list of tuples in
    which the first element has been transformed by \texttt{proc}. This
    combinator will allow us to operate on one of copies generated by split.
    \begin{scalacode}
    def first[A, B, C](proc: JsonProc[A, B]): JsonProc[(A, C), (B, C)]
    \end{scalacode}

    \item Implement the combinator \texttt{second}. The input to first is a
    generic \texttt{JsonProc} called \texttt{proc} that consumes a value of
    type `A' and returns a value of type `B'. The output of \texttt{first} is
    a \texttt{JsonProc} that consumes a tuple and returns a list of tuples in
    which the second element has been transformed by \texttt{proc}. This
    combinator will allow us to operate on one of copies generated by split.
    \begin{scalacode}
    def second[A, B, C](proc: JsonProc[A, B]): JsonProc[(C, A), (C, B)]
    \end{scalacode}

\end{enumerate}

\input{handin}
